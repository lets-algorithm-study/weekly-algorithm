# 백트래킹

아파트를 나섰을때, 지하철까지 왔는데 지갑을 두고 왔다.
그럼 우선은 아파트로 돌아갈 것이고, 집으로 돌아가서 방을 하나씩 살펴볼 것이다.
혹시라도 옆집으로 잘못왔다하더라도, 금방 아 옆집이지 하면서 우리집으로 다시 향할 것이다.

이런식으로 어떤 가능성이 없는 곳을 알아보고 되돌아가는 것을 백트래킹이라고 한다.
(예시로 이해하면 쉬우나, 말이 어려운듯..?)

## 백트래킹 알고리즘이란?

가능성이 없는 곳에서 되돌아가고, 가능성이 있는 곳을 탐색하는 알고리즘을 백트래킹 알고리즘이라고 한다.

- 백트래킹 알고리즘은 문제마다 효율이 다름.
- 시간 복잡도를 특정하여 정의하기 어렵움.

확실한 건, 백트래킹을 통해 해가 될 가능성이 없는 탐색 대상을 배제할 수 있어서,
탐색 효율이 단순히 완전 탐색하는 방법보다 백트래킹이 효율적이다.

> 백트래킹 알고리즘의 핵심은 '해가 될 가능성을 판단하는 것'

## 유망 함수란?

가능성을 유망 함수라고 정의

## 백트래킹 알고리즘 과정

1. 유효한 해의 집합을 정의
2. 위 단계에서 정의한 집합을 그래프로 표현한다.
3. 유망 함수를 정의한다.
4. 백트래킹 알고리즘을 활용해서 해를 찾는다.

## 합이 6이 넘는 경우

1.2.3.4 중에 2개를 뽑아 합이 6을 초과하는 경우를 알아낼때,
숫자들을 나열하고, 그래프로 표현한다.
그래프를 보면서 백트래킹을 수행하는데,
처음에 뽑은 숫자가 3 미만이면 백트래킹을 한다. 라는 전략을 사용한다.

그럼 1,2는 아예 탐색을 안할 것이다.
이렇게 특정 조건을 정의하는 것을 유망 함수라고 정의한다.

그래서 1, 2는 유망함수를 통과하지 못해서 백트래킹한다.

3은 유망 함수를 통과한다.
1,2는 유망함수와 상관없이 깊이 우선 탐색 알고리즘에 의해 방문은 하지만,
답이 아니라서 백트래킹을 하는 것이다.

그 이후에 3 -> 4 순으로 탐색이 진행된다.

## 부분 집합 합

1부터 N까지 숫자를 조합했을때 합이 K가 되는 조합을 찾는 문제일때,
전체 탐색과 백트레킹을 각각 풀어보고 알고리즘의 장점을 비교해보자.

### 완전 탐색으로 풀기

N이 4고, K = 5 일때
원 안의 숫자는 현재까지 뽑은 숫자들의 합을 의미.
동그라미는 그 수를 뽑는다. 엑스는 안뽑는다.
모든 수를 탐색해서 16번의 탐색을 진행

### 백트래킹으로 풀기

완전 탐색은 답이 될 가능성이 없는 조합도 탐색을 함.
유망 함수를 활용해서 답이 될 가능성이 없는 경우는 최대한 탐색이 안되도록 해보자.

조건 1. 현재 조합으로 합이 K가 되면 더 탐색하지 않는다.
조건 2. 해당 숫자를 조합하여 합이 K 이상이 되면 더 탐색하지 않는다.

문제를 풀기전에 어떤 상황에서 유망함수가 백트래킹시키는지 생각해봐야함.
우선은 2,3 을 뽑으면 이미 합이 5라 더 뽑지 않아도 됨.
조건 1에 맞기 때문에 백트래킹 한다.
1,2 를 뽑고 3을 뽑으면 6이라 5보다 크니까 3이후는 뽑지 않아도 되니까 백트래킹한다.

백트래킹을 통해 탐색을 안한 노드들이 많아졌다.
완전 탐색을 했다면, 모든 노드들을 다 탐색했어야 했다.
백트래킹은 탐색의 효율을 크게 높여준다.

## 퀸 문제

체스의 퀸을 N X N 체스판에 N개 배치했을때
서로 공격할 수 없는 위치에 놓을 수 있는 방법이 있는지 찾는다.
체스를 모르는 독자를 위해 퀸을 설명하자면 퀸은 다음과 같이 이동할 수 있는 말이다.

퀸의 경로에 다른 퀸이 있으면 공격해서 제거할 수 있다.
그렇게 되지 않도록 퀸을 배치할 수 있는지를 알아보는 문제이다.
퀸은 서로를 공격할 수 없다.

### 완전 탐색

완전 탐색은 퀸을 놓을 수 있는 경우의 수를 모두 탐색하는 방식이다.
각 줄에 퀸을 놓을 수 있는 방법은 N개 시간 복잡도는 O(Nn)
예를 들어 4 X 4 일때,
(1,1)(2,3)(3,2)(4,1)
(3,2)(2,3) 은 대각선이라 그 이후는 탐색할 필요가 없음

### 백트래킹으로 풀기

유명 함수를 추가해서 탐색 대상을 줄여보자.

- 여왕이 추가될때마다 행이나 대각선 방향에 겹치는 여왕이 있으면 더 탐색하지 않는다.

(1,2)(2,3) 이후 (3,2)를 만나면 대각선 상에서 (2,3)이랑 겹치니까 유망함수에서 걸러진다.
그 이후는 더 탐색하지 않고 백트래킹한다.

## 집합의 종류

- 유한 집합
- 무한 집합
- 공집합
- **상호 배타적 집합**

## 상호 배타적 집합이란?

> 교집합이 없는 집합 관계

집합 A
1,2,3

집합 B
4,5,6,7

겹치는 원소가 없으면 교집합이 없다 = 상호배타적 집합

## 활용

- 그래프 알고리즘
- 이미지 분할
- 도로 네트워크 구성
- 최소 신장 트리 알고리즘 구현
- 게임 개발
- 클러스터링 작업

### 배열을 활용한 트리로 집합 표현

### 대표 원소?

집합의 원소중 집합을 대표하는 역할
루트 노드 = 대표 원소

### 배열로 집합을 표현하는 것?

하나의 배열로 상호배타적 관계를 가지는 집합을 모두 표현한다.

**배열의 인덱스는 자신을, 배열값은 부모 노드를 의미한다.**

2
/ \
5 7
/
3
|
9

2가 루트노드
9가 마지막 숫자 -> 배열의 크기는 10

## 유니온-파인드 알고리즘

집합 알고리즘에 주로 쓰이는 연산은 합치기와 탐색.

합치키는 유니온 / 탐색을 파인드

## 파인드 연산

특정 노드의 루트 노드가 무엇인지 탐색하는 방법

특정 노드가 같은 집합에 있는지 확인할 때 사용

A,B 노드가 있을때 노드들의 루트 노드가 같다면 서로 같은 집합에 속함

## 파인드의 연산의 연산 비용 문제, 경로 압축

집합 형태를 유지하면서 트리 높이를 줄이면 된다.

## 유니온 연산

두 집합을 하나로 합치는 연산
두 집합을 합친다는 것은 두 집합의 루트 노드를 갖게 한다는 것

## 유니온 연산의 연산 비용 문제, 랭크로 해결하자

유니언 연산은 트리가 깊어지면 연산 비용이 커진다는 단점이 있다.

그래서 랭크가 필요

## 랭크란

현재 노드를 기준으로
가장 깊은 노드까지의 경로 길이를 말함
